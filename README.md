# Вступление
Для выполнения домашнего задания была взята статья с сайта https://tproger.ru/translations/powershell-tutorial/ 

Авторские права принадлежат авторам.
Все изменения сделаны для отработки синтаксиса.

# Руководство по Windows PowerShell для начинающих

*Перевод статьи «Windows PowerShell Scripting Tutorial for Beginners»*

**PowerShell** — это объектно-ориентированный программный движок и скриптовый язык с интерфейсом командной строки, предоставляющий IT-профессионалам более широкие возможности для конфигурирования операционных систем семейства MS Windows. Проще говоря, это своего рода универсальный инструмент администрирования. В данной статье будут рассмотрены базовые приёмы написания скриптов на **PowerShell**, позволяющие простым путём автоматизировать управление Windows-окружением.

**PowerShell** предлагает как чисто консольный интерфейс, так и полноценную среду разработки **PowerShell ISE** (Integrated Scripting Environment, встроенное скриптовое окружение) для скриптов. Для запуска интерфейса командной строки введите powershell в меню **Выполнить** (WinKey + R). **PowerShell ISE** запускается с помощью команды **PowerShell ISE** в том же меню.

**ISE** более предпочтительно, так как предоставляет более широкие возможности разработчику благодаря подсветке синтаксиса, функции автозаполнения кода и другим особенностям, присущим многим «большим» IDE.

![скриншот запуска](https://s3.tproger.ru/uploads/2018/10/PS2.jpg)


# 1\. Написание и запуск скриптов

Скрипты сохраняются в виде файлов с расширением `.ps1`. Несмотря на то, что PowerShell уже давно является нативной частью ОС Windows, вы не сможете запустить его скрипты простым двойным щелчком. Для этого надо кликнуть правой кнопкой по скрипту и выбрать **Запустить в PowerShell**.

Также существуют системные политики, ограничивающие выполнение скриптов. Можно проверить текущие параметры политики, введя команду `Get-ExecutionPolicy`. Результатом будет одно из следующих значений:

* **Resticted** - выполнение скриптов запрещено. Стандартная конфигурация;
* **AllSigned** - можно запускать скрипты, доверенным разработчиком; перед запуском скрипта PowerShell запросит у вас подтверждение;
* **RemoteSigned** - можно запускать собственные скрипты или те, что подписаны доверенным разработчиком;
* **Unrestricted** - можно запускать любые скрипты.


Для начала работы необходимо изменить настройку политики запуска на **RemoteSigned**, используя команду `Set-ExecutionPolicy`:

![скриншот изменения](https://s3.tproger.ru/uploads/2018/10/PS5-768x79.jpg)


# 2\. Командлеты

**Командлеты** — это команды с предопределённой функцией, подобные условным операторам в языках программирования. У них есть несколько ключевых особенностей:

* существуют системные, пользовательские и опциональные командлеты;
* результатом выполнения командлета будет объект или массив объектов;
* командлеты могут обрабатывать данные и передавать их другим командлетам с помощью конвейеров;
* командлеты нечувствительны к регистру, так что нет никакой разницы между `Get-ADUser, get-aduser и gEt-AdUsEr`;
* в качестве разделителя используется символ **;** .

Каждый командлет содержит в себе глагол и существительное, разделяемые дефисом. Например:

`Get-Process` — отобразить текущие процессы, запущенные на компьютере;
`Get-Service` — отобразить список служб и их статус;
`Get-Content` — отобразить содержимое указанного файла, например `Get-Content C:\Windows\System32\drivers\etc\hosts`.

При необходимости список всех доступных командлетов можно вывести с помощью `Get-Help-Category`:

![скриншот вызова_командлетов](https://s3.tproger.ru/uploads/2018/10/PS7.png)

Также можно создавать и свои собственные командлеты.

# 3\. Параметры

У каждого командлета есть несколько параметров, определяющих его работу. **PowerShell ISE** автоматически предлагает все доступные параметры с отображением их типа. Например, `Get-Service-NameW*` выводит список служб, у которых имя начинается с **W**. Если вы забыли, какие параметры у введённого командлета, воспользуйтесь `Get-Member`. Например, `Get-Process | Get-Member`:

![скриншот вызова_параметров](https://s3.tproger.ru/uploads/2018/10/PS9-768x682.jpg)

Если вы не нашли того, что нужно, или не уверены в том, как правильно задаются параметры, можно даже запросить примеры с помощью параметра `-Examples`:

![скриншот вызова_помощи](https://s3.tproger.ru/uploads/2018/10/PS10-768x563.jpg)

Некоторые командлеты также могут вызываться с помощью алиасов, например вместо `Get-Help` можно просто написать `Help`.

При написании больших скриптов или коллективной разработке можно пользоваться комментариями. Каждый комментарий начинается с символа **#**, а блок комментариев ограничивается комбинациями символов **<#** и **#>** в начале и в конце соответственно.

# 4\. Конвейер

PowerShell позволяет осуществлять обмен данными между командлетами с помощью конвейера. Например:

* GetService | SortObject -property Status — сортировка запущенных служб по статусу;
* “Hello World!” | Out-File C:\ps\test.txt — запись текста в файл.

Можно использовать несколько конвейеров. Например, следующий скрипт выводит список имён всех служб за исключением остановленных:

`Get-Service | WHERE {$_.status -eq “Running”} | SELECT displayname`

# Заключение

Итак, благодаря этому руководству у новичков появилось представление о том, что из себя представляет **PowerShell**. Также мы рассмотрели варианты изменения политики выполнения скриптов, что такое командлет, как они обмениваются данными с помощью конвейера и как получить свойства нужного объекта. Помните, что в случае затруднений можно воспользоваться командлетом `Get-Help`.


Поскольку не все показанные приемы встречаются в тексте, то выношу их отдельными пунктами))).

**Чисто для отработки...**

1. Пункт 1
1. Пункт 2
    * подпункт 2.1
    * подпункт 2.2
        * подподпункт 2.2.1
        * подподпункт 2.2.2
1. Пункт 3


Блок кода
``` Pascal
    if wages > tax_threshold then
        begin
        paystax := true;
        tax := (wages - tax_threshold) * tax_rate
        { The block structure makes it easier to see how the code could
          be refactored for clarity, and also makes it easier to do,
          because the structure of the inner conditional can easily be moved
          out of the outer conditional altogether and the effects of doing
          so are easily predicted. }
        if wages > supertax_threshold then
            begin
            pays_supertax := true;
            supertax := (wages - supertax_threshold) * supertax_rate
            end
        else begin
            pays_supertax := false;
            supertax := 0
            end
        end
    else begin
        paystax := false; pays_supertax := false;
        tax := 0; supertax := 0
        end;
    taxed := wages - tax - supertax;
```

**Таблица**
| Квест                | Компания             | Оценка          |
| :------------------- | :------------------- |:----------------|
| Сталкер              | Зона                 | Хорошо          |
| Опасный рейд         | Москва 2048          | Отлично         |
| Заброшенное метро    | В_тупике             | Отлично         |
| Заброшенное метро 2  | В_тупике             | Отлично         |
